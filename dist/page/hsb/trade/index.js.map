{"version":3,"sources":["../../../../page/hsb/trade/index.js"],"names":["ctx","Page","onLoad","params","userInfo","wx","getStorageSync","tel","us_uid","login","navigateTo","url","getWxCode","then","getWxOpenId","code","data","openid","setUserInfo","loginRes","unionid"],"mappings":";;AAAA;;;;;;AACA,IAAIA,YAAJ;AACAC,KAAK;AACHC,QADG,kBACKC,MADL,EACa;AACdH,UAAM,IAAN;AACA,QAAII,WAAWC,GAAGC,cAAH,CAAkB,UAAlB,CAAf;AACA,QAAG,EAAEF,YAAYA,SAASG,GAArB,IAA4BH,SAASI,MAAvC,CAAH,EAAmDR,IAAIS,KAAJ;AACnDJ,OAAGK,UAAH,CAAc,EAAEC,oBAAF,EAAd;AACD,GANE;AAOHF,OAPG,mBAOM;AACP,mBAAKG,SAAL,GAAiBC,IAAjB,CAAsB,gBAAQ;AAC5B,qBAAKC,WAAL,CAAiBC,IAAjB,EAAuBF,IAAvB,CAA4B,gBAAQ;AAClC,uBAAKJ,KAAL,CAAWO,KAAKC,MAAhB,EAAwBJ,IAAxB,CAA6B,oBAAY;AACvC,yBAAKK,WAAL,CAAiBC,QAAjB;AACD,SAFD,EAEG,eAAO;AACR;AACAd,aAAGK,UAAH,CAAc,EAAEC,+BAA8BK,KAAKC,MAAnC,iBAAuDD,KAAKI,OAA9D,EAAd;AACD,SALD;AAMD,OAPD;AAQD,KATD;AAUD;AAlBE,CAAL","file":"index.js","sourcesContent":["import user from '../../../model/user'\nlet ctx;\nPage({\n  onLoad (params) {\n    ctx = this;\n    let userInfo = wx.getStorageSync('userInfo');\n    if(!(userInfo && userInfo.tel && userInfo.us_uid)) ctx.login();\n    wx.navigateTo({ url: `../test/index` })\n  },\n  login () {\n    user.getWxCode().then(code => {\n      user.getWxOpenId(code).then(data => {\n        user.login(data.openid).then(loginRes => {\n          user.setUserInfo(loginRes);\n        }, err => {\n          // C++不支持errCode识别，这里假设错误都是用户没有绑定手机号\n          wx.navigateTo({ url: `../bind/index?openid=${ data.openid }&unionid=${ data.unionid }` })\n        })\n      })\n    })\n  }\n});"]}