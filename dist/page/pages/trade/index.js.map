{"version":3,"sources":["../../../../page/pages/trade/index.js"],"names":["ctx","Page","data","ways","name","way","iconBlack","iconWhite","sf","addr","indexs","selects","value","date","hsb","street","nickname","tel","coupon","userInfo","onLoad","wx","setNavigationBarTitle","title","sfCity","then","temp","sub","sfAddrFormat","setData","visitTime","res","time","formatSfDate","formatHsbDate","hsbCity","hsbAddrFormat","onShow","getUserInfo","page","uid","us_uid","userkey","option","getCurPageOpt","getAvailableCoupon","cps","parseInt","price","i","length","push","join","handleSfAddr","e","detail","handleSfAddrCol","event","index","column","handleHsbAddrCol","handleSfDateCol","handleHsbDateCol","switchWay","dataset","currentTarget","options","showModel","classId","handleName","handleTel","handleStreet","validParam","val","ctn","showModal","content","showCancel","takeHsbVisitOrder","params","address","regionId","Date","substr","replace","getTime","take","Object","assign","reLaunch","url","JSON","stringify","console","log","err","takeSfOrder","sendtime","addrArr","split","ordernum","orderid","submitOrder","isMobile","wxToken","getWxToken","productId","desc","itemid","openid","type","olduid","old_uid","keys","couponId","couponID"],"mappings":"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","file":"index.js","sourcesContent":["import trade from '../../../model/trade';\nimport order from '../../../model/order';\nimport user from '../../../model/user';\nimport coupon from '../../../model/coupon';\nimport Utils from '../../../util/utils';\nlet ctx;\n\nPage({\n\n  data: {\n    ways: [{\n      name: '顺丰上门取件',\n      way: 'sf',\n      iconBlack: '../../../img/trade/sf_black.svg',\n      iconWhite: '../../../img/trade/sf_white.svg'\n    }, {\n      name: '上门回收（免费）',\n      way: 'visit',\n      iconBlack: '../../../img/trade/visit_black.svg',\n      iconWhite: '../../../img/trade/visit_white.svg'\n    }],\n    way: 'sf',\n    sf: {\n      addr: {\n        data: [],\n        indexs: [0, 0, 0],\n        selects: [[], [], []],\n        value: '',\n      },\n      date: {\n        data: [],\n        indexs: [0, 0],\n        selects: [[], []],\n        value: ''\n      },\n    },\n    hsb: {\n      addr: {\n        data: [],\n        indexs: [0, 0],\n        selects: [[], []],\n        value: '',\n      },\n      date: {\n        data: [],\n        indexs: [0, 0],\n        selects: [[], []],\n        value: ''\n      },\n    },\n    street: '',\n    nickname: '',\n    tel: '',\n    coupon: {}, // 选中的优惠券\n    userInfo: {}\n  },\n\n  /**\n   * 初始化顺丰上门城市\n   * 初始化回收宝上门城市\n   * 初始化上门时间\n   */\n  onLoad () {\n    ctx = this;\n    let sf = ctx.data.sf;\n    let hsb = ctx.data.hsb;\n    wx.setNavigationBarTitle({\n      title: '提交订单'\n    });\n\n    // 获取顺丰城市\n    trade.sfCity().then(data => {\n      let temp = {};\n      sf.addr.data = data;\n      sf.addr.selects[0] = data;\n      temp = data[0];\n      if (temp.sub) sf.addr.selects[1] = temp.sub;\n      temp = temp.sub[0];\n      if (temp.sub) sf.addr.selects[2] = temp.sub;\n      sf.addr.value = ctx.sfAddrFormat(sf);\n      ctx.setData({\n        sf\n      });\n    });\n\n    // 获取上门时间\n    trade.visitTime().then(res => {\n      sf.date.data = res.sf;\n      sf.date.selects[0] = res.sf.date;\n      sf.date.selects[1] = res.sf.time[0];\n      sf.date.value = ctx.formatSfDate(sf);\n      hsb.date.data = res.hsb;\n      hsb.date.selects[0] = res.hsb.date;\n      hsb.date.selects[1] = res.hsb.time[0];\n      hsb.date.value = ctx.formatHsbDate(hsb);\n      ctx.setData({\n        sf,\n        hsb\n      });\n    });\n\n    // 回收宝城市\n    trade.hsbCity().then(data => {\n      hsb.addr.data = data;\n      hsb.addr.selects[0] = data;\n      hsb.addr.selects[1] = data[0]['sub'];\n      hsb.addr.value = ctx.hsbAddrFormat(hsb);\n      ctx.setData({\n        hsb\n      });\n    })\n  },\n\n  onShow () {\n    let userInfo = user.getUserInfo();\n    let tel = ctx.data.tel;\n    ctx.setData({\n      userInfo,\n      tel: userInfo.tel ? userInfo.tel : tel\n    });\n    if (userInfo.tel) {\n      coupon.page({\n        uid: userInfo.us_uid,\n        userkey: userInfo.userkey,\n      }).then(cps => {\n        let option = Utils.getCurPageOpt();\n        let coupon = Utils.getAvailableCoupon(cps, parseInt(option.price));\n        if (coupon)\n          ctx.setData({\n            coupon\n          })\n      })\n    }\n  },\n\n  // 格式化顺丰地址\n  sfAddrFormat (sf) {\n    let temp = [];\n    for (let i = 0; i < 3; i++) {\n      if (sf.addr.selects[i].length) temp.push(sf.addr.selects[i][sf.addr.indexs[i]]['name']);\n    }\n    return temp.join(\" \");\n  },\n\n  // 格式化回收宝地址\n  hsbAddrFormat (hsb) {\n    let temp = [];\n    for (let i = 0; i < 2; i++) {\n      if (hsb.addr.selects[i].length) temp.push(hsb.addr.selects[i][hsb.addr.indexs[i]]['name']);\n    }\n    return temp.join(\" \");\n  },\n\n  // 确认顺丰地址\n  handleSfAddr (e) {\n    let sf = this.data.sf;\n    sf.addr.indexs = e.detail.value;\n    this.setData({\n      sf\n    });\n  },\n\n  // 监听pickerCol变化\n  handleSfAddrCol (event) {\n    let sf = ctx.data.sf;\n    let index = event.detail.value;\n    let column = event.detail.column;\n    switch (column) {\n      case 0:\n        sf.addr.selects[1] = sf.addr.data[index]['sub'];\n        if (sf.addr.selects[1][0]['sub']) {\n          sf.addr.selects[2] = sf.addr.selects[1][0]['sub']\n        } else {\n          sf.addr.selects[2] = [];\n        }\n        sf.addr.indexs[column + 1] = 0;\n        sf.addr.indexs[column + 2] = 0;\n        break;\n      case 1:\n        if (sf.addr.selects[column][index]['sub']) {\n          sf.addr.selects[2] = sf.addr.selects[column][index]['sub']\n        } else {\n          sf.addr.selects[2] = [];\n        }\n        sf.addr.indexs[column + 1] = 0;\n        break;\n    }\n    sf.addr.indexs[column] = index;\n    sf.addr.value = ctx.sfAddrFormat(sf);\n    this.setData({\n      sf,\n    });\n  },\n\n  // 监听pickerCol变化\n  handleHsbAddrCol (e) {\n    let hsb = ctx.data.hsb;\n    let index = e.detail.value;\n    let column = e.detail.column;\n    switch (column) {\n      case 0:\n        hsb.addr.selects[1] = hsb.addr.data[index]['sub'];\n        hsb.addr.indexs[column] = index;\n        hsb.addr.indexs[column + 1] = 0;\n        break;\n      case 1:\n        hsb.addr.indexs[1] = index;\n        break;\n    }\n    hsb.addr.value = ctx.hsbAddrFormat(hsb);\n    this.setData({\n      hsb\n    });\n  },\n\n  // 监听pickerCol变化\n  handleSfDateCol (e) {\n    let sf = ctx.data.sf;\n    let index = e.detail.value;\n    let column = e.detail.column;\n    if (column == 0) sf.date.selects[1] = sf.date.data.time[index];\n    sf.date.indexs[column] = index;\n    sf.date.value = ctx.formatSfDate(sf);\n    this.setData({\n      sf\n    });\n  },\n\n  // 监听pickerCol变化\n  handleHsbDateCol (e) {\n    let hsb = ctx.data.hsb;\n    let index = e.detail.value;\n    let column = e.detail.column;\n    if (column == 0) hsb.date.selects[1] = hsb.date.data.time[index];\n    hsb.date.indexs[column] = index;\n    hsb.date.value = this.formatHsbDate(hsb);\n    this.setData({\n      hsb\n    });\n  },\n\n  // 格式化顺丰日期\n  formatSfDate (sf) {\n    let temp = [];\n    for (let i = 0; i < 2; i++) {\n      if (sf.date.selects[i].length) temp.push(sf.date.selects[i][sf.date.indexs[i]]);\n    }\n    return temp.join(\" \");\n  },\n\n  formatHsbDate (hsb) {\n    let temp = [];\n    for (let i = 0; i < 2; i++) {\n      if (hsb.date.selects[i].length) temp.push(hsb.date.selects[i][hsb.date.indexs[i]]);\n    }\n    return temp.join(\" \");\n  },\n\n  // 更换回收方式\n  switchWay(e) {\n    let dataset = e.currentTarget.dataset;\n    let options = Utils.getCurPageOpt();\n\n    if (parseInt(options.price) < 100) {\n      ctx.showModel('未满100元不支持上门回收');\n      return;\n    }\n\n    if (options.classId == 2) {\n      ctx.showModel('笔记本暂不支持上门回收');\n      return;\n    }\n\n    ctx.setData({\n      way: dataset.way\n    })\n  },\n\n  handleName (e) {\n    this.setData({\n      nickname: e.detail.value\n    })\n  },\n\n  handleTel (e) {\n    this.setData({\n      tel: e.detail.value\n    })\n  },\n\n  handleStreet (e) {\n    this.setData({\n      street: e.detail.value\n    })\n  },\n\n  validParam (val) {\n    return val && val.length > 0;\n  },\n\n  showModel (ctn) {\n    wx.showModal({\n      title: '提示',\n      content: ctn,\n      showCancel: false\n    });\n  },\n\n  // 下回收宝上门单\n  takeHsbVisitOrder (params) {\n\n    let hsb = ctx.data.hsb;\n\n    let street = ctx.data.street;\n    let address = hsb.addr.value + street;\n    let date = hsb.date.value;\n\n    if (!ctx.validParam(street)) {\n      ctx.showModel('请填写详细地址');\n      return false;\n    }\n\n    if (!ctx.validParam(address)) {\n      ctx.showModel('请选择城市');\n      return false;\n    }\n\n    if (!ctx.validParam(date)) {\n      ctx.showModel('请选择预约时间');\n      return false;\n    }\n\n    let regionId = hsb.addr.selects[0][hsb.addr.indexs[0]]['id'];\n    let visitTime = new Date((date.substr(0, 16) + ':00').replace(/-/g, '/')).getTime() / 1000;\n\n    params['ordertype'] = 'visit';\n    params['address'] = address;\n    params['regionid'] = regionId;\n    params['visitTime'] = visitTime;\n    params['address'] = address;\n    params['displayVisitTime'] = date; // 前端展示上门时间\n\n    order.take(params).then(data => {\n      Object.assign(params, data);\n      wx.reLaunch({\n        url: `../success/index?orderInfo=${JSON.stringify(params)}`\n      })\n    }, err => {\n      console.log(err);\n    });\n  },\n\n  // 下顺丰单\n  takeSfOrder (params) {\n\n    let sf = ctx.data.sf;\n\n    let street = ctx.data.street;\n    let address = sf.addr.value;\n    let date = sf.date.value;\n\n    if (!ctx.validParam(street)) {\n      ctx.showModel('请填写详细地址');\n      return false;\n    }\n\n    if (!ctx.validParam(address)) {\n      ctx.showModel('请选择城市');\n      return false;\n    }\n\n    if (!ctx.validParam(date)) {\n      ctx.showModel('请选择预约时间');\n      return false;\n    }\n\n    let sendtime = new Date(date).getTime() / 1000;\n    let addrArr = address.split(' ');\n\n    params['ordertype'] = 'post';\n\n    order.take(params).then(data => {\n      params['ordernum'] = data.ordernum;\n      params['orderid'] = data.orderid; //订单号\n      params['sendtime'] = sendtime; // 上门时间\n      params['province'] = addrArr[0] || ''; // 省\n      params['city'] = addrArr[1] || ''; // 市\n      params['county'] = addrArr[2] || ''; // 区\n      params['addr'] = `${address} ${street}`; // 上门地址\n      params['displayVisitTime'] = date; // 前端展示上门时间\n      wx.reLaunch({\n        url: `../success/index?orderInfo=${JSON.stringify(params)}`\n      })\n    });\n  },\n\n  // 基本参数\n  submitOrder () {\n\n    // 需要填写\n    let tel = ctx.data.tel;\n    let nickname = ctx.data.nickname;\n\n    if (nickname.length < 2) {\n      wx.showModal({\n        title: '提示',\n        content: '联系人字符长度不能小于2',\n        showCancel: false\n      });\n      return;\n    }\n\n    if (!Utils.isMobile(tel)) {\n      wx.showModal({\n        title: '提示',\n        content: '手机号码格式不正确',\n        showCancel: false\n      });\n      return;\n    }\n\n    // 不需要填写\n    let options = Utils.getCurPageOpt();\n    let userInfo = user.getUserInfo();\n    let wxToken = user.getWxToken();\n    let coupon = ctx.data.coupon;\n\n    if (!options.productId) {\n      options = {\n        selects: \"137-123-12-73-68-61-65-59-55-53-30-23-21-9-10\",\n        price: \"96400\",\n        productId: \"30800\",\n        desc: '大陆国行-保修一个月以上-128G-金色-无拆机无维修-显示正常-屏幕完好-外观完好-iCloud已注销-A1586-机身完好-二手-正常开机-非官换机-液晶正常-指纹功能正常-WIFI正常-无进水-通话正常'\n      };\n    }\n\n    let params = {\n      // 估价选项\n      selects: options.selects,\n      // 产品id\n      itemid: options.productId,\n      //新uid\n      uid: userInfo.us_uid,\n      // 授权id\n      openid: wxToken.openid,\n      // 收款方式\n      type: 9,\n      //旧uid\n      olduid: userInfo.old_uid,\n      userkey: userInfo.userkey,\n      // 用户昵称\n      nickname: nickname,\n      // 联系电话\n      tel: tel\n    };\n\n    Object.keys(coupon).length && (params.couponId = coupon.couponID);\n\n    let way = ctx.data.way;\n    if (way === 'sf') ctx.takeSfOrder(params);\n    if (way === 'visit') ctx.takeHsbVisitOrder(params);\n  }\n});"]}